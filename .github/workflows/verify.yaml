name: Chart Verifier

on:
  push:
  workflow_dispatch:


jobs:
  chart-verifier:
    name: Chart Verifier
    runs-on: ubuntu-20.04
    steps:
      - uses: redhat-actions/oc-login@v1
        with:
          openshift_server_url: ${{ secrets.OPENSHIFT_SERVER }}
          openshift_token: ${{ secrets.OPENSHIFT_TOKEN }}

      - run: echo $KUBECONFIG

      - uses: actions/checkout@v2
        # with:
        #   path: chart-verifier-action

      # - uses: actions/checkout@v2
      #   with:
      #     repository: redhat-actions/openshift-actions-runner-chart
      #     path: runner-chart
      #     ref: main

      - uses: ./
        with:
          chart_uri: https://github.com/redhat-actions/openshift-actions-runner-chart/blob/release-chart/packages/actions-runner-1.1.tgz?raw=true
          verify_args: --chart-set githubOwner=tetchel
          fail: false
